import scanpy as sc
from pathlib import Path


def simulated_data():
    """
    Simulated dataset generated by scCbe (Nat Commun, 2024).
    The human PBMCs scRNA-seq dataset from Kang et al. (Nat Biotechnol, 2018) contains eight control and eight IFN-β treated samples
    :return:
    """
    HERE = Path(__file__).parent
    filename = HERE / "simulated_data.h5ad.gz"
    adata = sc.read_h5ad(filename)
    return adata


def mouse_spleen_codex():
    """
    Processed mouse spleen CODEX dataset from Goltsev et al. (Cell, 2018), containing 1 wild-type spleen sample
    (BALBc-1) with the compartment labels.

    This downloads 25.83 MB of data upon the first call of the function and stores it in `./scniche_data/BALBc-1.h5ad`.
    :return: AnnData
    """
    url = "https://figshare.com/ndownloader/files/46669087"
    datasetdir = './scniche_data/BALBc-1.h5ad'
    adata = sc.read(datasetdir, backup_url=url)
    return adata


def human_utuc_imc():
    """
    Processed human upper tract urothelial carcinoma (UTUC) IMC dataset from Ohara et al. (Nat Commun, 2024),
    containing 16 images with manually annotated topological domain labels.

    This downloads 70.62 MB of data upon the first call of the function and stores it in `./scniche_data/UTUC.h5ad`.
    :return: AnnData
    """
    url = "https://figshare.com/ndownloader/files/46669108"
    datasetdir = './scniche_data/UTUC.h5ad'
    adata = sc.read(datasetdir, backup_url=url)
    return adata


def mouse_v1_starmap():
    """
    Raw mouse V1 neocortex dataset from Wang et al. (Science, 2018), containing 1 slice replicate with the layer labels.

    This downloads 9.6 MB of data upon the first call of the function and stores it in `./scniche_data/STARmap.h5ad`.
    :return: AnnData
    """
    url = "https://figshare.com/ndownloader/files/50249244"
    datasetdir = './scniche_data/STARmap.h5ad'
    adata = sc.read(datasetdir, backup_url=url)
    return adata


def human_dlpfc_visium():
    """
    Raw human DLPFC dataset from Maynard et al. (Nat Neurosci., 2021),
    containing 4 slices (Slice 151673, 151674, 151675, and 151676) from the same donor with the layer labels.
    The scVI (Nat Methods., 2018) embedding as well as the Cell2location (Nat Biotechnol., 2022) deconvolution results
    are also provided.

    This downloads 71.93 MB of data upon the first call of the function and stores it in `./scniche_data/DLPFC.h5ad`.
    :return: AnnData
    """
    url = "https://figshare.com/ndownloader/files/50249673"
    datasetdir = './scniche_data/DLPFC.h5ad'
    adata = sc.read(datasetdir, backup_url=url)
    return adata


def mouse_aging_merfish():
    """
    processed mouse aging brain dataset from Allen et al. (Cell, 2023), containing 31 slices with the tissue labels.
    The data has been normalized and scaled by the original authors, and the PCA results are also provided.

    This downloads 281.56 MB of data upon the first call of the function and stores it in `./scniche_data/MERFISH_Aging.h5ad`.
    :return: AnnData
    """
    url = "https://figshare.com/ndownloader/files/50251680"
    datasetdir = './scniche_data/MERFISH_Aging.h5ad'
    adata = sc.read(datasetdir, backup_url=url)
    return adata


def human_tnbc_mibi_tof():
    """
    Processed human triple-negative breast cancer (TNBC) MIBI-TOF dataset from Keren et al. (Cell, 2018),
    containing 173,205 cells from 19 mixed subtype samples and 15 compartmentalized subtype samples.
    The cell niches have been identified by scNiche.

    This downloads 106.84 MB of data upon the first call of the function and stores it in `./scniche_data/TNBC.h5ad`.
    :return: AnnData
    """
    url = "https://figshare.com/ndownloader/files/47153020"
    datasetdir = './scniche_data/TNBC.h5ad'
    adata = sc.read(datasetdir, backup_url=url)

    return adata


def mouse_liver_seq_scope():
    """
    Processed mouse liver Seq-Scope dataset from Cho et al. (Cell, 2021), containing 37,505 cells from 6 normal donors
    and 4 early-onset liver failure induced by excessive mTORC1 signaling (Tsc1Δhep/Depdc5Δhep or TD model) donors.
    The cell niches have been identified by scNiche.

    This downloads 57.15 MB of data upon the first call of the function and stores it in `./scniche_data/Liver.h5ad`.
    :return: AnnData
    """
    url = "https://figshare.com/ndownloader/files/47153125"
    datasetdir = './scniche_data/Liver.h5ad'
    adata = sc.read(datasetdir, backup_url=url)

    return adata

